<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Vue list pour mb.renting.stock.period.config -->
    <record id="view_mb_renting_stock_period_config_list" model="ir.ui.view">
        <field name="name">mb.renting.stock.period.config.list</field>
        <field name="model">mb.renting.stock.period.config</field>
        <field name="arch" type="xml">
            <list editable="bottom">
                <!-- Le champ period_id est invisible mais toujours présent pour le filtrage -->
                <field name="period_id" invisible="1"/>
                <field name="storable_product_ids" widget="many2many_tags" options="{'no_create': True}" string="Produits stockables"/>
                <field name="total_stock_by_product" string="Détail du stock par produit"/>
                <!-- Élargit la colonne en définissant une largeur spécifique -->
                <field name="stock_available_for_period" string="Stock disponible pour la période" width="200"/>
                <!-- Ajout du compteur de produits stockables -->
                <field name="storable_product_count" string="Nb produits configurés"/>
            </list>
        </field>
    </record>
    
    <record id="view_mb_renting_period_form" model="ir.ui.view">
        <field name="name">mb.renting.period.form</field>
        <field name="model">mb.renting.period</field>
        <field name="arch" type="xml">
            <form>
                <group>
                    <group>
                        <field name="name"/>
                        <field name="company_id" invisible="1"/>
                        <field name="start_date"/>
                        <field name="end_date"/>
                        <field name="is_closed"/>
                    </group>
                    <group>
                        <field name="minimal_time_duration"/>
                        <field name="minimal_time_unit"/>
                        <field name="total_storable_products" string="Total produits stockables" readonly="1"/>
                        <field name="remaining_products_to_configure" string="Produits restants à configurer" readonly="1"/>
                    </group>
                </group>
                <notebook>
                    <page string="Configuration des jours">
                        <field name="day_configs" context="{'default_company_id': company_id, 'default_period_id': id}"/>
                    </page>
                    <page string="Configuration des stocks">
                        <field name="stock_period_config_ids" context="{'default_period_id': id}" domain="[('period_id', '=', id)]">
                            <list editable="bottom">
                                <field name="storable_product_ids" widget="many2many_tags" options="{'no_create': True}"/>
                                <field name="total_stock_by_product" readonly="1"/>
                                <field name="stock_available_for_period" width="250"/>
                            </list>
                        </field>
                    </page>
                </notebook>
            </form>
        </field>
    </record>
    
    <!-- Vue list pour mb.renting.day.config (déjà en list, gardée pour référence) -->
    <record id="view_mb_renting_day_config_list" model="ir.ui.view">
        <field name="name">mb.renting.day.config.list</field>
        <field name="model">mb.renting.day.config</field>
        <field name="arch" type="xml">
            <list editable="bottom">
                <field name="company_id" invisible="1"/>
                <field name="period_id" invisible="1"/>
                <field name="day_of_week"/>
                <field name="is_open"/>
                <field name="allow_pickup"/>
                <field name="pickup_hour_from" widget="float_time"/>
                <field name="pickup_hour_to" widget="float_time"/>
                <field name="allow_return"/>
                <field name="return_hour_from" widget="float_time"/>
                <field name="return_hour_to" widget="float_time"/>
            </list>
        </field>
    </record>

    <record id="res_config_settings_view_form_rental_periods" model="ir.ui.view">
        <field name="name">res.config.settings.view.form.inherit.rental.periods</field>
        <field name="model">res.config.settings</field>
        <field name="inherit_id" ref="sale_renting.res_config_settings_view_form"/>
        <field name="arch" type="xml">
            <!-- Supprimer tout le bloc "Rent Online" et le remplacer par notre contenu personnalisé -->
            <xpath expr="//block[@id='sale_renting_product_settings']" position="replace">
                <block title="Rent Online" id="sale_renting_product_settings">
                    <h2>Configuration des périodes de location</h2>
                    <div class="row mt16 o_settings_container" id="rental_seasonal_settings">
                        <div class="col-12 col-lg-12 o_setting_box">
                            <div class="o_setting_right_pane">
                                <span class="o_form_label">Périodes de location</span>
                                <div class="text-muted">
                                    Définir les périodes de location et leurs configurations associées
                                </div>
                                <div class="content-group">
                                    <div class="mt16">
                                        <field name="renting_periods" context="{'default_company_id': company_id}"/>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </block>
            </xpath>
        </field>
    </record>
</odoo>
